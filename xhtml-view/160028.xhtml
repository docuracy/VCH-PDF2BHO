<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta content="application/xhtml+xml"/>
    <title>Wychwood Forest and Cornbury Park</title>
</head>
<body class="vch-report" data-pubid="160028">
<hr class="vch-page" data-idstart="249"/>
<p class="subtitle">Author: Simon Townley</p>

<section>
    <h2>Preparing VCH Content in XHTML for BHO</h2>

    <p>This document demonstrates the simplicity of preparing VCH content in standard XHTML for use in BHO.</p>

    <ul>
        <li>The numbering of elements requires no manual intervention. If you need to force a specific number, add a
            <code>data-idstart</code> attribute to the relevant element; the automatic sequence continues from that point.
        </li>

        <li>Footnotes can be written inline using <code>&lt;aside&gt;</code> elements.</li>

        <li>The document can be previewed in any modern web browser without additional tooling.</li>

        <li>The page title is entered once in the <code>&lt;head&gt;</code> and is automatically inserted and capitalised at the start
            of the visible document.
        </li>

        <li>Formatting uses ordinary, readable XHTML elements:
            <ul>
                <li><u>underline</u></li>
                <li><em>italic</em></li>
                <li><strong>bold</strong></li>
                <li><code>&lt;table&gt;</code></li>
                <li><code>&lt;figure&gt;</code> and <code>&lt;figcaption&gt;</code></li>
            </ul>
        </li>

        <li>Images are specified using a <code>&lt;figure data-src="..."&gt;</code> element; the image file is injected
            automatically for previewing.
        </li>

        <li>Page breaks are indicated using <code>&lt;hr class="vch-page"&gt;</code>. Page numbers are added
            automatically.
        </li>

        <li>Use of XHTML ensures strict adherence to XML rules, simplifying automated processing and reducing parsing
            errors.
        </li>

        <li>Transformation into the XML format required by Drupal (including element numbering and extraction of <code>&lt;aside&gt;</code>
            notes into a separate, hyperlinked block) can be handled entirely by an XSLT stylesheet.
        </li>

        <li>The document remains editable in any standard text or XML editor.</li>

        <li>The same XHTML can be converted into formats such as PDF or Word using standard tools, or ingested by other
            content management systems as needed.
        </li>
    </ul>
</section>

<hr class="vch-page"/>

<section>
    <p>From the eleventh to the 19th century Wychwood was one of the great royal forests of England,
        <aside>This account was written in 2016–17...</aside>
        comparable with Savernake, Rockingham, or Whittlewood.
        <aside>Oxon. Atlas, pp. 48–9...</aside>
        Its boundaries as a legal entity were the subject of repeated conflict.
        <aside>Below (boundaries).</aside>
    </p>
</section>

<section>
    <h2>Landscape, Settlement, and Buildings</h2>

    <h3>Forest and Park Boundaries To 1857</h3>

    <p>When first mentioned <em>c</em>.840–2 ‘Wychwood’ (Huiccewudu) comprised a large and apparently ill-defined
        area.
        <aside>Sawyer S.196...</aside>
        By 1086, along with Cornbury, Woodstock, Shotover, and Stowood, it formed one of Oxfordshire’s royal demesne
        forests.
        <aside>DB, f. 154v.</aside>
    </p>

    <figure data-number="71" data-src="../images/VCH.jpeg">
        <figcaption>71. Wychwood forest boundaries c.1154–1300.</figcaption>
    </figure>

    <p>Following inquisitions in 1219 and 1229 the forest was reduced to the alleged bounds of 1154.
        <aside>Schumer, ‘Perambulations’, 2–19.</aside>
        James I attempted further enlargement in a bid to increase royal revenues, but in 1641 Charles I was forced
        to accept a
    </p>

    <table>
        <caption>Forest Area Estimates (<u>fictitious example</u>)</caption>
        <thead>
        <tr>
            <th>Year</th>
            <th>Estimated Area (acres)</th>
            <th>Source</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1154</td>
            <td>7,000</td>
            <td>
                <aside>Schumer, ‘Perambulations’, 12.</aside>
            </td>
        </tr>
        <tr>
            <td>1229</td>
            <td>5,400</td>
            <td>
                <aside>Oxon. Atlas, p. 49.</aside>
            </td>
        </tr>
        <tr>
            <td>1641</td>
            <td>4,800</td>
            <td>
                <aside>DB, f. 154v.</aside>
            </td>
        </tr>
        </tbody>
    </table>

    <hr class="vch-page"/>

    <p>return to the earlier bounds.
        <aside>Schumer, ‘Perambulations’, 22–5.</aside>
    </p>
</section>

<style data-ignore="true">
    body {
        font-family: 'Times New Roman', serif;
        max-width: 900px;
        margin: 40px auto;
        line-height: 1.6;
        color: #333;
        padding: 20px;
    }

    section {
        margin-bottom: 2em;
    }

    h1 {
        font-size: 2em;
        border-bottom: 2px solid #333;
    }

    h2 {
        font-size: 1.5em;
        font-weight: bold;
        color: #444;
        margin-top: 1.5em;
        letter-spacing: 0.05em;
    }

    h3 {
        font-size: 1.2em;
        font-weight: bold;
        font-style: italic;
        color: #555;
    }

    u {
        text-decoration: underline;
    }

    .title {
        text-transform: uppercase;
    }

    p.subtitle {
        font-style: italic;
        color: #666;
        font-size: 1.2em;
    }

    hr.vch-page {
        border: 0;
        border-top: 1px dashed #999;
        margin: 30px 0;
        position: relative;
        height: 1px;
        overflow: visible;
    }

    hr.vch-page::after {
        content: " Page " attr(data-page) " ";
        position: absolute;
        top: -0.7em;
        left: 50%;
        transform: translateX(-50%);
        background: #fff;
        padding: 0 10px;
        color: #cc0000;
        font-weight: bold;
        font-size: 0.8em;
        border: 1px solid #ddd;
        border-radius: 10px;
    }

    span.vch-page {
        border-bottom: 2px solid red;
        margin: 0 2px;
        position: relative;
    }

    span.vch-page::before {
        content: "[p." attr(data-page) "]";
        font-size: 0.7em;
        color: red;
        vertical-align: super;
        font-weight: bold;
    }

    aside {
        display: inline;
        position: relative;
        cursor: help;
    }

    aside::before {
        content: "[" attr(data-preview-num) "]";
        vertical-align: super;
        font-size: 0.7em;
        color: #0066cc;
        font-weight: bold;
        margin-left: 2px;
    }

    aside span.note-content {
        display: none;
        position: absolute;
        bottom: 150%;
        left: 50%;
        transform: translateX(-50%);
        width: 300px;
        background-color: #333;
        color: #fff;
        text-align: left;
        padding: 10px;
        border-radius: 4px;
        font-size: 0.85rem;
        line-height: 1.4;
        z-index: 1000;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }

    aside span.note-content::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #333 transparent transparent transparent;
    }

    aside:hover span.note-content {
        display: block;
    }

    figure {
        background: #f9f9f9;
        padding: 10px;
        border: 1px solid #ddd;
        text-align: center;
        margin: 20px 0;
    }

    figcaption {
        font-size: 0.9em;
        margin-top: 10px;
        font-style: italic;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5em 0;
        font-size: 0.95em;
    }

    table caption {
        caption-side: top;
        font-weight: bold;
        font-style: italic;
        text-align: left;
        margin-bottom: 0.5em;
    }

    table th,
    table td {
        border: 1px solid #ccc;
        padding: 6px 10px;
        vertical-align: top;
    }

    table th {
        background: #f0f0f0;
        font-weight: bold;
    }

    table tbody tr:nth-child(even) {
        background: #fafafa;
    }
</style>

<script type="text/javascript">
    //<![CDATA[
    document.addEventListener("DOMContentLoaded", function () {
        var root = document.querySelector('.vch-report');
        var startVal = parseInt(root.getAttribute('data-idstart')) || 1;
        var allNotes = document.querySelectorAll('aside');

        var sourceNotes = [];
        var counter = startVal;

        // Extract title from head section and insert it at the start of the document or after an hr if present
        const title = document.querySelector('head > title').innerText || 'Untitled Document';
        var titleElement = document.createElement('h1');
        titleElement.className = 'title';
        titleElement.innerText = title;
        var firstHr = document.querySelector('body > hr.vch-page');
        if (firstHr) {
            firstHr.parentNode.insertBefore(titleElement, firstHr.nextSibling);
        } else {
            root.insertBefore(titleElement, root.firstChild);
        }

        // Insert images into figure elements
        var figures = document.querySelectorAll('figure[data-src]');
        figures.forEach(function (figure) {
            var imgSrc = figure.getAttribute('data-src');
            var img = document.createElement('img');
            img.src = imgSrc;
            img.style.maxWidth = '100%';
            figure.insertBefore(img, figure.firstChild);
        });

        // Add page numbers to hr.vch-page elements
        var pageMarkers = document.querySelectorAll('hr.vch-page');
        var currentPageNum = parseInt(pageMarkers[0].getAttribute('data-idstart')) || 1;
        pageMarkers.forEach(function (marker, index) {
            marker.setAttribute('data-page', currentPageNum + index);
        });

        // Remove space from before aside elements
        allNotes.forEach(function (note) {
            if (note.previousSibling && note.previousSibling.nodeType === Node.TEXT_NODE) {
                note.previousSibling.textContent = note.previousSibling.textContent.replace(/\s+$/, '');
            }
        });

        // Process each aside element
        for (var i = 0; i < allNotes.length; i++) {
            var note = allNotes[i];

            // Trim trailing whitespace before the aside
            var prev = note.previousSibling;
            if (prev && prev.nodeType === Node.TEXT_NODE) {
                prev.textContent = prev.textContent.replace(/\s+$/, '');
            }

            // Number and record this note
            note.setAttribute('data-preview-num', counter);
            sourceNotes[counter] = note;
            counter++;

            // Wrap contents in <span class="note-content">
            var contentSpan = document.createElement('span');
            contentSpan.className = 'note-content';

            while (note.firstChild) {
                contentSpan.appendChild(note.firstChild);
            }

            note.appendChild(contentSpan);
        }

    });
    //]]>
</script>

</body>
</html>